{"ast":null,"code":"import { call, put, takeLatest, select } from 'redux-saga/effects';\nimport { Cookies } from 'react-cookie';\nimport { push } from 'connected-react-router';\nimport axios from 'axios';\nimport * as AuthSlice from 'containers/Auth/authSlice'; // import * as UserSlice from 'containers/Users/usersSlice';\n\nimport * as CONSTANTS from 'common/constants';\nimport * as API from 'common/api';\nimport { enqueueSnackbar as enqueueSnackbarAction // closeSnackbar as closeSnackbarAction,\n} from 'components/Notifier/actions'; // import { redirectSignin } from 'common/redirects';\n// const hostname = window && window.location && window.location.hostname;\n\nconst cookies = new Cookies();\nexport function* signIn(actions) {\n  const body = actions.payload;\n  const options = {\n    url: API.LOGIN_API,\n    method: 'POST',\n    data: JSON.stringify(body)\n  };\n\n  try {\n    var _authResponse$data, _authResponse$data$da, _authResponse$data$da2;\n\n    const authResponse = yield call(axios, options);\n\n    if (authResponse === null || authResponse === void 0 ? void 0 : (_authResponse$data = authResponse.data) === null || _authResponse$data === void 0 ? void 0 : (_authResponse$data$da = _authResponse$data.data) === null || _authResponse$data$da === void 0 ? void 0 : (_authResponse$data$da2 = _authResponse$data$da.AuthenticationResult) === null || _authResponse$data$da2 === void 0 ? void 0 : _authResponse$data$da2.IdToken) {\n      var _authResponse$data2, _authResponse$data2$d, _authResponse$data2$d2, _authResponse$data3;\n\n      const token = authResponse === null || authResponse === void 0 ? void 0 : (_authResponse$data2 = authResponse.data) === null || _authResponse$data2 === void 0 ? void 0 : (_authResponse$data2$d = _authResponse$data2.data) === null || _authResponse$data2$d === void 0 ? void 0 : (_authResponse$data2$d2 = _authResponse$data2$d.AuthenticationResult) === null || _authResponse$data2$d2 === void 0 ? void 0 : _authResponse$data2$d2.IdToken; // const { exp } = JSON.parse(atob(token.split('.')[1]));\n      // const expires = new Date(exp * 1000);\n\n      yield cookies.set(CONSTANTS.JWT_NAME, token, {\n        path: '/'\n      });\n      yield put(AuthSlice.signInSuccess(authResponse === null || authResponse === void 0 ? void 0 : (_authResponse$data3 = authResponse.data) === null || _authResponse$data3 === void 0 ? void 0 : _authResponse$data3.data));\n      yield put(push(CONSTANTS.DASHBOARD_PAGE));\n      yield put(enqueueSnackbarAction({\n        message: 'Login successfully',\n        options: {\n          key: new Date().getTime() + Math.random(),\n          variant: 'success',\n          action: () => null\n        }\n      }));\n    } else {\n      const error = 'You have entered wrong credentials.';\n      yield put(AuthSlice.signInFailed(error));\n    }\n  } catch (error) {\n    yield put(AuthSlice.signInFailed(error.name));\n  }\n}\nexport function* socialLogin(actions) {\n  const body = actions.payload;\n  const options = {\n    url: body.social_type === 'google' ? API.GOOGLE_LOGIN_API : API.FACEBOOK_LOGIN_API,\n    method: 'POST',\n    data: JSON.stringify(body)\n  };\n\n  try {\n    // eslint-disable-next-line no-unused-vars\n    const authResponse = yield call(axios, options); // console.log(authResponse);\n  } catch (error) {\n    // console.log(error.name);\n    // console.log(error.message);\n    yield put(AuthSlice.socialLoginFailed(error));\n  }\n}\nexport function* signUp(actions) {\n  const body = actions.payload;\n  const options = {\n    url: API.SIGN_UP_API,\n    method: 'POST',\n    data: JSON.stringify({ ...body,\n      mobile_number: `+27${body.mobile_number}`\n    })\n  };\n\n  try {\n    const authResponse = yield call(axios, options);\n    yield put(AuthSlice.signUpSuccess(authResponse.data));\n    yield put(enqueueSnackbarAction({\n      message: `Confirmation code successfully sent to ${body === null || body === void 0 ? void 0 : body.mobile_number}`,\n      options: {\n        key: new Date().getTime() + Math.random(),\n        variant: 'success',\n        action: () => null\n      }\n    }));\n  } catch (error) {\n    yield put(AuthSlice.signUpFailed(error.name));\n    yield put(enqueueSnackbarAction({\n      message: error.message,\n      options: {\n        key: new Date().getTime() + Math.random(),\n        variant: 'error',\n        action: () => null\n      }\n    }));\n  }\n}\nexport function* mobileVerify(actions) {\n  const body = actions.payload;\n  const options = {\n    url: API.MOBILE_VERIFY_API,\n    method: 'POST',\n    data: JSON.stringify(body)\n  };\n\n  try {\n    var _authResponse$data4, _authResponse$data7;\n\n    const authResponse = yield call(axios, options);\n\n    if ((authResponse === null || authResponse === void 0 ? void 0 : (_authResponse$data4 = authResponse.data) === null || _authResponse$data4 === void 0 ? void 0 : _authResponse$data4.code) === 'CodeMismatchException') {\n      var _authResponse$data5, _authResponse$data6;\n\n      yield put(AuthSlice.mobileVerifyFailed(authResponse === null || authResponse === void 0 ? void 0 : (_authResponse$data5 = authResponse.data) === null || _authResponse$data5 === void 0 ? void 0 : _authResponse$data5.message));\n      yield put(enqueueSnackbarAction({\n        message: authResponse === null || authResponse === void 0 ? void 0 : (_authResponse$data6 = authResponse.data) === null || _authResponse$data6 === void 0 ? void 0 : _authResponse$data6.message,\n        options: {\n          key: new Date().getTime() + Math.random(),\n          variant: 'error',\n          action: () => null\n        }\n      }));\n    } else if ((authResponse === null || authResponse === void 0 ? void 0 : (_authResponse$data7 = authResponse.data) === null || _authResponse$data7 === void 0 ? void 0 : _authResponse$data7.code) === 'ExpiredCodeException') {\n      var _authResponse$data8, _authResponse$data9;\n\n      yield put(AuthSlice.mobileVerifyFailed(authResponse === null || authResponse === void 0 ? void 0 : (_authResponse$data8 = authResponse.data) === null || _authResponse$data8 === void 0 ? void 0 : _authResponse$data8.message));\n      yield put(enqueueSnackbarAction({\n        message: authResponse === null || authResponse === void 0 ? void 0 : (_authResponse$data9 = authResponse.data) === null || _authResponse$data9 === void 0 ? void 0 : _authResponse$data9.message,\n        options: {\n          key: new Date().getTime() + Math.random(),\n          variant: 'error',\n          action: () => null\n        }\n      }));\n    } else {\n      yield put(AuthSlice.mobileVerifySuccess(authResponse.data));\n      yield put(push(CONSTANTS.DISCLAIMER_PAGE));\n    }\n  } catch (error) {\n    yield put(AuthSlice.mobileVerifyFailed(error.message)); // yield put(\n    //   enqueueSnackbarAction({\n    //     message: error.message,\n    //     options: {\n    //       key: new Date().getTime() + Math.random(),\n    //       variant: 'error',\n    //       action: () => null,\n    //     },\n    //   }),\n    // );\n  }\n}\nexport function* disclaimer() {\n  const options = {\n    url: API.DISCLAIMER_API,\n    method: 'PUT',\n    data: JSON.stringify({\n      agree: 'yes'\n    })\n  };\n\n  try {\n    const authResponse = yield call(axios, options); // console.log(authResponse);\n\n    yield put(AuthSlice.disclaimerSuccess(authResponse.data));\n  } catch (error) {\n    yield put(AuthSlice.disclaimerFailed(error.message)); // yield put(\n    //   enqueueSnackbarAction({\n    //     message: error.message,\n    //     options: {\n    //       key: new Date().getTime() + Math.random(),\n    //       variant: 'error',\n    //       action: () => null,\n    //     },\n    //   }),\n    // );\n  }\n}\nexport function* signOut() {\n  try {\n    const expires = new Date();\n    yield cookies.remove(CONSTANTS.JWT_NAME, {\n      path: '/',\n      expires\n    });\n    yield put(AuthSlice.signOutSuccess());\n    yield put(push(CONSTANTS.LOGIN_PAGE));\n    yield put(enqueueSnackbarAction({\n      message: 'Logout successfully',\n      options: {\n        key: new Date().getTime() + Math.random(),\n        variant: 'success',\n        action: () => null\n      }\n    }));\n  } catch (error) {\n    yield put(AuthSlice.signOutFailed(error));\n    yield put(enqueueSnackbarAction({\n      message: error === null || error === void 0 ? void 0 : error.message,\n      options: {\n        anchorOrigin: {\n          vertical: 'top',\n          horizontal: 'right'\n        },\n        key: new Date().getTime() + Math.random(),\n        variant: 'error',\n        action: () => null\n      }\n    }));\n  }\n}\nexport function* confirmSignUp(actions) {\n  const {\n    email,\n    confirmationCode\n  } = actions.payload;\n\n  try {\n    // eslint-disable-next-line no-undef\n    const authResponse = yield Auth.confirmSignUp(email, confirmationCode);\n    yield put(AuthSlice.confirmSignUpSuccess(authResponse)); // yield put(push(CONSTANTS.SIGNIN));\n\n    yield put(enqueueSnackbarAction({\n      message: 'User confirmed successfully',\n      options: {\n        key: new Date().getTime() + Math.random(),\n        variant: 'success',\n        action: () => null\n      }\n    }));\n  } catch (error) {\n    yield put(AuthSlice.confirmSignUpFailed(error));\n    yield put(enqueueSnackbarAction({\n      message: error.message,\n      options: {\n        key: new Date().getTime() + Math.random(),\n        variant: 'error',\n        action: () => null\n      }\n    }));\n  }\n}\nexport function* loginSuccessSaga(data) {\n  const {\n    signInUserSession\n  } = data;\n  const {\n    payload\n  } = signInUserSession.idToken;\n\n  switch (payload['cognito:groups'][0]) {\n    case 'SuperAdmin':\n      {\n        // yield put(push(VERIFICATION_PAGE));\n        return;\n      }\n\n    case 'Admin':\n      {\n        // const uri = `${redirectSignin(hostname)}/${payload.profile}${CONSTANTS.DASHBOARD}`;\n        // yield put(push(`/r/${encodeURIComponent(uri)}`));\n        return;\n      }\n\n    case 'Consultant':\n      {\n        // const uri = `${redirectSignin(hostname)}/${payload.profile}${CONSTANTS.DASHBOARD}`;\n        // yield put(push(`/r/${encodeURIComponent(uri)}`));\n        return;\n      }\n    // TODO: Error page, user\n\n    default:\n      {\n        yield put(push(CONSTANTS.ROOT));\n      }\n  }\n}\nexport function* forgotPassword(actions) {\n  const options = {\n    url: API.FORGOT_PASSWORD_API,\n    method: 'POST',\n    data: JSON.stringify(actions.payload)\n  };\n\n  try {\n    const authResponse = yield call(axios, options);\n    yield put(AuthSlice.forgotPasswordSuccess(authResponse));\n  } catch (error) {\n    yield put(AuthSlice.forgotPasswordFailed(error.message));\n  }\n}\nexport function* resetPassword(actions) {\n  const options = {\n    url: API.RESET_PASSWORD_API,\n    method: 'POST',\n    data: JSON.stringify(actions.payload)\n  };\n\n  try {\n    const authResponse = yield call(axios, options);\n    yield put(AuthSlice.resetPasswordSuccess(authResponse));\n  } catch (error) {\n    yield put(AuthSlice.resetPasswordFailed(error.message));\n  }\n}\nexport function* contactUs(actions) {\n  const options = {\n    url: API.CONTACT_US_API,\n    method: 'POST',\n    data: JSON.stringify(actions.payload)\n  };\n\n  try {\n    const authResponse = yield call(axios, options);\n    yield put(AuthSlice.contactUsSuccess(authResponse));\n  } catch (error) {\n    yield put(AuthSlice.contactUsFailed(error.message));\n  }\n}\nexport function* confirmPassword(actions) {\n  const {\n    Username,\n    SessionCode,\n    NewPassword\n  } = actions.payload;\n\n  try {\n    // eslint-disable-next-line no-undef\n    const authResponse = yield Auth.forgotPasswordSubmit(Username, SessionCode, NewPassword);\n    yield put(AuthSlice.resetPasswordSuccess(authResponse)); // yield put(push(CONSTANTS.SIGNIN));\n\n    yield put(enqueueSnackbarAction({\n      message: 'Password changed successfully',\n      options: {\n        key: new Date().getTime() + Math.random(),\n        variant: 'success',\n        action: () => null\n      }\n    }));\n  } catch (error) {\n    yield put(AuthSlice.confirmPasswordFailed(error));\n    yield put(enqueueSnackbarAction({\n      message: error.message,\n      options: {\n        key: new Date().getTime() + Math.random(),\n        variant: 'error',\n        action: () => null\n      }\n    }));\n  }\n}\nexport function* changePassword(actions) {\n  // console.log(actions);\n  const {\n    OldPassword,\n    NewPassword,\n    isAccount\n  } = actions.payload;\n\n  try {\n    // eslint-disable-next-line no-undef\n    const user = yield Auth.currentAuthenticatedUser(); // eslint-disable-next-line no-undef\n\n    const authResponse = yield Auth.changePassword(user, OldPassword, NewPassword);\n    yield put(AuthSlice.changePasswordSuccess(authResponse));\n\n    if (!isAccount) {// yield put(push(CONSTANTS.SIGNIN));\n    }\n\n    yield put(enqueueSnackbarAction({\n      message: 'Password changed successfully',\n      options: {\n        key: new Date().getTime() + Math.random(),\n        variant: 'success',\n        action: () => null\n      }\n    }));\n  } catch (error) {\n    yield put(AuthSlice.changePasswordFailed(error));\n    yield put(enqueueSnackbarAction({\n      message: error.message,\n      options: {\n        key: new Date().getTime() + Math.random(),\n        variant: 'error',\n        action: () => null\n      }\n    }));\n  }\n}\nexport function* updateUserAttributes(actions) {\n  const {\n    idToken\n  } = yield select(AuthSlice.selectUserSession);\n  const username = actions.payload['cognito:username']; // console.log(attributes);\n\n  const options = {\n    url: `${API.USERS_API}/${username}`,\n    method: 'put',\n    headers: {\n      Authorization: idToken.jwtToken\n    },\n    data: actions.payload\n  };\n\n  try {\n    const authResponse = yield call(axios, options); // console.log(authResponse);\n    // const user = yield Auth.currentAuthenticatedUser();\n    // const authResponse = yield Auth.updateUserAttributes(user, {\n    //   name,\n    //   family_name,\n    // });\n    // const currentSession = yield Auth.currentSession();\n    // yield put(AuthSlice.userSession(currentSession));\n\n    yield put(AuthSlice.updateUserAttributesSuccess(authResponse));\n    yield put(enqueueSnackbarAction({\n      message: 'Account updated successfully',\n      options: {\n        key: new Date().getTime() + Math.random(),\n        variant: 'success',\n        action: () => null\n      }\n    }));\n  } catch (error) {\n    yield put(AuthSlice.updateUserAttributesFailed(error));\n    yield put(enqueueSnackbarAction({\n      message: error.message,\n      options: {\n        key: new Date().getTime() + Math.random(),\n        variant: 'error',\n        action: () => null\n      }\n    }));\n  }\n}\nexport function* validateInvite(actions) {\n  const options = {\n    url: API.VALIDATE_USER_INVITE_API,\n    method: 'post',\n    data: actions.payload\n  };\n\n  try {\n    const authResponse = yield call(axios, options);\n    yield put(AuthSlice.validateInviteSuccess(authResponse.data.data)); // yield put(push(CONSTANTS.CUSTOMERS));\n\n    yield put(enqueueSnackbarAction({\n      message: authResponse.data.message,\n      options: {\n        key: new Date().getTime() + Math.random(),\n        variant: 'success',\n        action: () => null\n      }\n    }));\n  } catch (error) {\n    yield put(AuthSlice.validateInviteFailed(error));\n    yield put(enqueueSnackbarAction({\n      message: error.message,\n      options: {\n        key: new Date().getTime() + Math.random(),\n        variant: 'error',\n        action: () => null\n      }\n    }));\n  }\n}\nexport function* deactivateUser(actions) {\n  const {\n    idToken\n  } = yield select(AuthSlice.selectUserSession);\n  const {\n    Username\n  } = actions.payload;\n  const options = {\n    url: `${API.USERS_API}/${Username}/deactivate`,\n    method: 'delete',\n    headers: {\n      Authorization: idToken.jwtToken\n    }\n  };\n\n  try {\n    const authResponse = yield call(axios, options);\n    yield put(AuthSlice.deactivateUserSuccess(authResponse.data.data));\n    yield put(enqueueSnackbarAction({\n      message: authResponse.data.message,\n      options: {\n        key: new Date().getTime() + Math.random(),\n        variant: 'success',\n        action: () => null\n      }\n    })); // yield put(UserSlice.retrieveUsers({ customerid }));\n  } catch (error) {\n    yield put(AuthSlice.deactivateUserFailed(error));\n    yield put(enqueueSnackbarAction({\n      message: error.message,\n      options: {\n        key: new Date().getTime() + Math.random(),\n        variant: 'error',\n        action: () => null\n      }\n    }));\n  }\n}\nexport default function* userSaga() {\n  yield takeLatest(AuthSlice.signIn.type, signIn);\n  yield takeLatest(AuthSlice.socialLogin.type, socialLogin);\n  yield takeLatest(AuthSlice.signOut.type, signOut);\n  yield takeLatest(AuthSlice.signUp.type, signUp);\n  yield takeLatest(AuthSlice.mobileVerify.type, mobileVerify);\n  yield takeLatest(AuthSlice.disclaimer.type, disclaimer);\n  yield takeLatest(AuthSlice.contactUs.type, contactUs);\n  yield takeLatest(AuthSlice.confirmSignUp.type, confirmSignUp);\n  yield takeLatest(AuthSlice.forgotPassword.type, forgotPassword);\n  yield takeLatest(AuthSlice.resetPassword.type, resetPassword);\n  yield takeLatest(AuthSlice.confirmPassword.type, confirmPassword);\n  yield takeLatest(AuthSlice.changePassword.type, changePassword);\n  yield takeLatest(AuthSlice.validateInvite.type, validateInvite);\n  yield takeLatest(AuthSlice.updateUserAttributes.type, updateUserAttributes);\n  yield takeLatest(AuthSlice.deactivateUser.type, deactivateUser);\n}","map":{"version":3,"sources":["/Users/lasimonne/Projects/syked.xyz/src/containers/Auth/saga.js"],"names":["call","put","takeLatest","select","Cookies","push","axios","AuthSlice","CONSTANTS","API","enqueueSnackbar","enqueueSnackbarAction","cookies","signIn","actions","body","payload","options","url","LOGIN_API","method","data","JSON","stringify","authResponse","AuthenticationResult","IdToken","token","set","JWT_NAME","path","signInSuccess","DASHBOARD_PAGE","message","key","Date","getTime","Math","random","variant","action","error","signInFailed","name","socialLogin","social_type","GOOGLE_LOGIN_API","FACEBOOK_LOGIN_API","socialLoginFailed","signUp","SIGN_UP_API","mobile_number","signUpSuccess","signUpFailed","mobileVerify","MOBILE_VERIFY_API","code","mobileVerifyFailed","mobileVerifySuccess","DISCLAIMER_PAGE","disclaimer","DISCLAIMER_API","agree","disclaimerSuccess","disclaimerFailed","signOut","expires","remove","signOutSuccess","LOGIN_PAGE","signOutFailed","anchorOrigin","vertical","horizontal","confirmSignUp","email","confirmationCode","Auth","confirmSignUpSuccess","confirmSignUpFailed","loginSuccessSaga","signInUserSession","idToken","ROOT","forgotPassword","FORGOT_PASSWORD_API","forgotPasswordSuccess","forgotPasswordFailed","resetPassword","RESET_PASSWORD_API","resetPasswordSuccess","resetPasswordFailed","contactUs","CONTACT_US_API","contactUsSuccess","contactUsFailed","confirmPassword","Username","SessionCode","NewPassword","forgotPasswordSubmit","confirmPasswordFailed","changePassword","OldPassword","isAccount","user","currentAuthenticatedUser","changePasswordSuccess","changePasswordFailed","updateUserAttributes","selectUserSession","username","USERS_API","headers","Authorization","jwtToken","updateUserAttributesSuccess","updateUserAttributesFailed","validateInvite","VALIDATE_USER_INVITE_API","validateInviteSuccess","validateInviteFailed","deactivateUser","deactivateUserSuccess","deactivateUserFailed","userSaga","type"],"mappings":"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","sourcesContent":["import { call, put, takeLatest, select } from 'redux-saga/effects';\nimport { Cookies } from 'react-cookie';\nimport { push } from 'connected-react-router';\nimport axios from 'axios';\nimport * as AuthSlice from 'containers/Auth/authSlice';\n// import * as UserSlice from 'containers/Users/usersSlice';\nimport * as CONSTANTS from 'common/constants';\nimport * as API from 'common/api';\nimport {\n  enqueueSnackbar as enqueueSnackbarAction,\n  // closeSnackbar as closeSnackbarAction,\n} from 'components/Notifier/actions';\n// import { redirectSignin } from 'common/redirects';\n// const hostname = window && window.location && window.location.hostname;\n\nconst cookies = new Cookies();\n\nexport function* signIn(actions) {\n  const body = actions.payload;\n  const options = {\n    url: API.LOGIN_API,\n    method: 'POST',\n    data: JSON.stringify(body),\n  };\n  try {\n    const authResponse = yield call(axios, options);\n    if (authResponse?.data?.data?.AuthenticationResult?.IdToken) {\n      const token = authResponse?.data?.data?.AuthenticationResult?.IdToken;\n      // const { exp } = JSON.parse(atob(token.split('.')[1]));\n      // const expires = new Date(exp * 1000);\n      yield cookies.set(CONSTANTS.JWT_NAME, token, { path: '/' });\n      yield put(AuthSlice.signInSuccess(authResponse?.data?.data));\n      yield put(push(CONSTANTS.DASHBOARD_PAGE));\n      yield put(\n        enqueueSnackbarAction({\n          message: 'Login successfully',\n          options: {\n            key: new Date().getTime() + Math.random(),\n            variant: 'success',\n            action: () => null,\n          },\n        }),\n      );\n    } else {\n      const error = 'You have entered wrong credentials.';\n      yield put(AuthSlice.signInFailed(error));\n    }\n  } catch (error) {\n    yield put(AuthSlice.signInFailed(error.name));\n  }\n}\n\nexport function* socialLogin(actions) {\n  const body = actions.payload;\n  const options = {\n    url: body.social_type === 'google' ? API.GOOGLE_LOGIN_API : API.FACEBOOK_LOGIN_API,\n    method: 'POST',\n    data: JSON.stringify(body),\n  };\n  try {\n    // eslint-disable-next-line no-unused-vars\n    const authResponse = yield call(axios, options);\n    // console.log(authResponse);\n  } catch (error) {\n    // console.log(error.name);\n    // console.log(error.message);\n    yield put(AuthSlice.socialLoginFailed(error));\n  }\n}\n\nexport function* signUp(actions) {\n  const body = actions.payload;\n  const options = {\n    url: API.SIGN_UP_API,\n    method: 'POST',\n    data: JSON.stringify({\n      ...body,\n      mobile_number: `+27${body.mobile_number}`,\n    }),\n  };\n  try {\n    const authResponse = yield call(axios, options);\n    yield put(AuthSlice.signUpSuccess(authResponse.data));\n    yield put(\n      enqueueSnackbarAction({\n        message: `Confirmation code successfully sent to ${body?.mobile_number}`,\n        options: {\n          key: new Date().getTime() + Math.random(),\n          variant: 'success',\n          action: () => null,\n        },\n      }),\n    );\n  } catch (error) {\n    yield put(AuthSlice.signUpFailed(error.name));\n    yield put(\n      enqueueSnackbarAction({\n        message: error.message,\n        options: {\n          key: new Date().getTime() + Math.random(),\n          variant: 'error',\n          action: () => null,\n        },\n      }),\n    );\n  }\n}\n\nexport function* mobileVerify(actions) {\n  const body = actions.payload;\n  const options = {\n    url: API.MOBILE_VERIFY_API,\n    method: 'POST',\n    data: JSON.stringify(body),\n  };\n  try {\n    const authResponse = yield call(axios, options);\n    if (authResponse?.data?.code === 'CodeMismatchException') {\n      yield put(AuthSlice.mobileVerifyFailed(authResponse?.data?.message));\n      yield put(\n        enqueueSnackbarAction({\n          message: authResponse?.data?.message,\n          options: {\n            key: new Date().getTime() + Math.random(),\n            variant: 'error',\n            action: () => null,\n          },\n        }),\n      );\n    } else if (authResponse?.data?.code === 'ExpiredCodeException') {\n      yield put(AuthSlice.mobileVerifyFailed(authResponse?.data?.message));\n      yield put(\n        enqueueSnackbarAction({\n          message: authResponse?.data?.message,\n          options: {\n            key: new Date().getTime() + Math.random(),\n            variant: 'error',\n            action: () => null,\n          },\n        }),\n      );\n    } else {\n      yield put(AuthSlice.mobileVerifySuccess(authResponse.data));\n      yield put(push(CONSTANTS.DISCLAIMER_PAGE));\n    }\n  } catch (error) {\n    yield put(AuthSlice.mobileVerifyFailed(error.message));\n    // yield put(\n    //   enqueueSnackbarAction({\n    //     message: error.message,\n    //     options: {\n    //       key: new Date().getTime() + Math.random(),\n    //       variant: 'error',\n    //       action: () => null,\n    //     },\n    //   }),\n    // );\n  }\n}\n\nexport function* disclaimer() {\n  const options = {\n    url: API.DISCLAIMER_API,\n    method: 'PUT',\n    data: JSON.stringify({ agree: 'yes' }),\n  };\n  try {\n    const authResponse = yield call(axios, options);\n    // console.log(authResponse);\n    yield put(AuthSlice.disclaimerSuccess(authResponse.data));\n  } catch (error) {\n    yield put(AuthSlice.disclaimerFailed(error.message));\n    // yield put(\n    //   enqueueSnackbarAction({\n    //     message: error.message,\n    //     options: {\n    //       key: new Date().getTime() + Math.random(),\n    //       variant: 'error',\n    //       action: () => null,\n    //     },\n    //   }),\n    // );\n  }\n}\n\nexport function* signOut() {\n  try {\n    const expires = new Date();\n    yield cookies.remove(CONSTANTS.JWT_NAME, { path: '/', expires });\n    yield put(AuthSlice.signOutSuccess());\n    yield put(push(CONSTANTS.LOGIN_PAGE));\n    yield put(\n      enqueueSnackbarAction({\n        message: 'Logout successfully',\n        options: {\n          key: new Date().getTime() + Math.random(),\n          variant: 'success',\n          action: () => null,\n        },\n      }),\n    );\n  } catch (error) {\n    yield put(AuthSlice.signOutFailed(error));\n    yield put(\n      enqueueSnackbarAction({\n        message: error?.message,\n        options: {\n          anchorOrigin: {\n            vertical: 'top',\n            horizontal: 'right',\n          },\n          key: new Date().getTime() + Math.random(),\n          variant: 'error',\n          action: () => null,\n        },\n      }),\n    );\n  }\n}\n\nexport function* confirmSignUp(actions) {\n  const { email, confirmationCode } = actions.payload;\n  try {\n    // eslint-disable-next-line no-undef\n    const authResponse = yield Auth.confirmSignUp(email, confirmationCode);\n    yield put(AuthSlice.confirmSignUpSuccess(authResponse));\n    // yield put(push(CONSTANTS.SIGNIN));\n    yield put(\n      enqueueSnackbarAction({\n        message: 'User confirmed successfully',\n        options: {\n          key: new Date().getTime() + Math.random(),\n          variant: 'success',\n          action: () => null,\n        },\n      }),\n    );\n  } catch (error) {\n    yield put(AuthSlice.confirmSignUpFailed(error));\n    yield put(\n      enqueueSnackbarAction({\n        message: error.message,\n        options: {\n          key: new Date().getTime() + Math.random(),\n          variant: 'error',\n          action: () => null,\n        },\n      }),\n    );\n  }\n}\n\nexport function* loginSuccessSaga(data) {\n  const { signInUserSession } = data;\n  const { payload } = signInUserSession.idToken;\n\n  switch (payload['cognito:groups'][0]) {\n    case 'SuperAdmin': {\n      // yield put(push(VERIFICATION_PAGE));\n\n      return;\n    }\n    case 'Admin': {\n      // const uri = `${redirectSignin(hostname)}/${payload.profile}${CONSTANTS.DASHBOARD}`;\n      // yield put(push(`/r/${encodeURIComponent(uri)}`));\n\n      return;\n    }\n    case 'Consultant': {\n      // const uri = `${redirectSignin(hostname)}/${payload.profile}${CONSTANTS.DASHBOARD}`;\n      // yield put(push(`/r/${encodeURIComponent(uri)}`));\n\n      return;\n    }\n    // TODO: Error page, user\n    default: {\n      yield put(push(CONSTANTS.ROOT));\n    }\n  }\n}\n\nexport function* forgotPassword(actions) {\n  const options = {\n    url: API.FORGOT_PASSWORD_API,\n    method: 'POST',\n    data: JSON.stringify(actions.payload),\n  };\n  try {\n    const authResponse = yield call(axios, options);\n    yield put(AuthSlice.forgotPasswordSuccess(authResponse));\n  } catch (error) {\n    yield put(AuthSlice.forgotPasswordFailed(error.message));\n  }\n}\n\nexport function* resetPassword(actions) {\n  const options = {\n    url: API.RESET_PASSWORD_API,\n    method: 'POST',\n    data: JSON.stringify(actions.payload),\n  };\n  try {\n    const authResponse = yield call(axios, options);\n    yield put(AuthSlice.resetPasswordSuccess(authResponse));\n  } catch (error) {\n    yield put(AuthSlice.resetPasswordFailed(error.message));\n  }\n}\nexport function* contactUs(actions) {\n  const options = {\n    url: API.CONTACT_US_API,\n    method: 'POST',\n    data: JSON.stringify(actions.payload),\n  };\n  try {\n    const authResponse = yield call(axios, options);\n    yield put(AuthSlice.contactUsSuccess(authResponse));\n  } catch (error) {\n    yield put(AuthSlice.contactUsFailed(error.message));\n  }\n}\n\nexport function* confirmPassword(actions) {\n  const { Username, SessionCode, NewPassword } = actions.payload;\n  try {\n    // eslint-disable-next-line no-undef\n    const authResponse = yield Auth.forgotPasswordSubmit(Username, SessionCode, NewPassword);\n    yield put(AuthSlice.resetPasswordSuccess(authResponse));\n    // yield put(push(CONSTANTS.SIGNIN));\n    yield put(\n      enqueueSnackbarAction({\n        message: 'Password changed successfully',\n        options: {\n          key: new Date().getTime() + Math.random(),\n          variant: 'success',\n          action: () => null,\n        },\n      }),\n    );\n  } catch (error) {\n    yield put(AuthSlice.confirmPasswordFailed(error));\n    yield put(\n      enqueueSnackbarAction({\n        message: error.message,\n        options: {\n          key: new Date().getTime() + Math.random(),\n          variant: 'error',\n          action: () => null,\n        },\n      }),\n    );\n  }\n}\n\nexport function* changePassword(actions) {\n  // console.log(actions);\n  const { OldPassword, NewPassword, isAccount } = actions.payload;\n  try {\n    // eslint-disable-next-line no-undef\n    const user = yield Auth.currentAuthenticatedUser();\n    // eslint-disable-next-line no-undef\n    const authResponse = yield Auth.changePassword(user, OldPassword, NewPassword);\n    yield put(AuthSlice.changePasswordSuccess(authResponse));\n    if (!isAccount) {\n      // yield put(push(CONSTANTS.SIGNIN));\n    }\n    yield put(\n      enqueueSnackbarAction({\n        message: 'Password changed successfully',\n        options: {\n          key: new Date().getTime() + Math.random(),\n          variant: 'success',\n          action: () => null,\n        },\n      }),\n    );\n  } catch (error) {\n    yield put(AuthSlice.changePasswordFailed(error));\n    yield put(\n      enqueueSnackbarAction({\n        message: error.message,\n        options: {\n          key: new Date().getTime() + Math.random(),\n          variant: 'error',\n          action: () => null,\n        },\n      }),\n    );\n  }\n}\n\nexport function* updateUserAttributes(actions) {\n  const { idToken } = yield select(AuthSlice.selectUserSession);\n  const username = actions.payload['cognito:username'];\n  // console.log(attributes);\n\n  const options = {\n    url: `${API.USERS_API}/${username}`,\n    method: 'put',\n    headers: {\n      Authorization: idToken.jwtToken,\n    },\n    data: actions.payload,\n  };\n\n  try {\n    const authResponse = yield call(axios, options);\n    // console.log(authResponse);\n    // const user = yield Auth.currentAuthenticatedUser();\n    // const authResponse = yield Auth.updateUserAttributes(user, {\n    //   name,\n    //   family_name,\n    // });\n    // const currentSession = yield Auth.currentSession();\n    // yield put(AuthSlice.userSession(currentSession));\n    yield put(AuthSlice.updateUserAttributesSuccess(authResponse));\n    yield put(\n      enqueueSnackbarAction({\n        message: 'Account updated successfully',\n        options: {\n          key: new Date().getTime() + Math.random(),\n          variant: 'success',\n          action: () => null,\n        },\n      }),\n    );\n  } catch (error) {\n    yield put(AuthSlice.updateUserAttributesFailed(error));\n    yield put(\n      enqueueSnackbarAction({\n        message: error.message,\n        options: {\n          key: new Date().getTime() + Math.random(),\n          variant: 'error',\n          action: () => null,\n        },\n      }),\n    );\n  }\n}\n\nexport function* validateInvite(actions) {\n  const options = {\n    url: API.VALIDATE_USER_INVITE_API,\n    method: 'post',\n    data: actions.payload,\n  };\n  try {\n    const authResponse = yield call(axios, options);\n    yield put(AuthSlice.validateInviteSuccess(authResponse.data.data));\n    // yield put(push(CONSTANTS.CUSTOMERS));\n    yield put(\n      enqueueSnackbarAction({\n        message: authResponse.data.message,\n        options: {\n          key: new Date().getTime() + Math.random(),\n          variant: 'success',\n          action: () => null,\n        },\n      }),\n    );\n  } catch (error) {\n    yield put(AuthSlice.validateInviteFailed(error));\n    yield put(\n      enqueueSnackbarAction({\n        message: error.message,\n        options: {\n          key: new Date().getTime() + Math.random(),\n          variant: 'error',\n          action: () => null,\n        },\n      }),\n    );\n  }\n}\n\nexport function* deactivateUser(actions) {\n  const { idToken } = yield select(AuthSlice.selectUserSession);\n  const { Username } = actions.payload;\n  const options = {\n    url: `${API.USERS_API}/${Username}/deactivate`,\n    method: 'delete',\n    headers: {\n      Authorization: idToken.jwtToken,\n    },\n  };\n  try {\n    const authResponse = yield call(axios, options);\n    yield put(AuthSlice.deactivateUserSuccess(authResponse.data.data));\n    yield put(\n      enqueueSnackbarAction({\n        message: authResponse.data.message,\n        options: {\n          key: new Date().getTime() + Math.random(),\n          variant: 'success',\n          action: () => null,\n        },\n      }),\n    );\n    // yield put(UserSlice.retrieveUsers({ customerid }));\n  } catch (error) {\n    yield put(AuthSlice.deactivateUserFailed(error));\n    yield put(\n      enqueueSnackbarAction({\n        message: error.message,\n        options: {\n          key: new Date().getTime() + Math.random(),\n          variant: 'error',\n          action: () => null,\n        },\n      }),\n    );\n  }\n}\n\nexport default function* userSaga() {\n  yield takeLatest(AuthSlice.signIn.type, signIn);\n  yield takeLatest(AuthSlice.socialLogin.type, socialLogin);\n  yield takeLatest(AuthSlice.signOut.type, signOut);\n  yield takeLatest(AuthSlice.signUp.type, signUp);\n  yield takeLatest(AuthSlice.mobileVerify.type, mobileVerify);\n  yield takeLatest(AuthSlice.disclaimer.type, disclaimer);\n  yield takeLatest(AuthSlice.contactUs.type, contactUs);\n  yield takeLatest(AuthSlice.confirmSignUp.type, confirmSignUp);\n  yield takeLatest(AuthSlice.forgotPassword.type, forgotPassword);\n  yield takeLatest(AuthSlice.resetPassword.type, resetPassword);\n  yield takeLatest(AuthSlice.confirmPassword.type, confirmPassword);\n  yield takeLatest(AuthSlice.changePassword.type, changePassword);\n  yield takeLatest(AuthSlice.validateInvite.type, validateInvite);\n  yield takeLatest(AuthSlice.updateUserAttributes.type, updateUserAttributes);\n  yield takeLatest(AuthSlice.deactivateUser.type, deactivateUser);\n}\n"]},"metadata":{},"sourceType":"module"}