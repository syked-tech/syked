{"ast":null,"code":"import _regeneratorRuntime from\"/Users/lasimonne/Projects/syked.xyz/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/lasimonne/Projects/syked.xyz/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/lasimonne/Projects/syked.xyz/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";/* eslint-disable no-unused-vars */import React,{useState,useEffect,useCallback}from'react';import{Cookies}from'react-cookie';import{compose}from'redux';import{connect,useSelector}from'react-redux';import{withRouter}from'react-router-dom';import{selectIsAuthenticated// selectUser,\n,userHasAuthenticated as userHasAuthenticatedAction,userSession as userSessionAction}from'containers/Auth/authSlice';import Notifier from'components/Notifier';import*as CONSTANTS from'common/constants';import Routes from'./Routes';import'./App.scss';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function App(_ref){var userHasAuthenticated=_ref.userHasAuthenticated,setUserSession=_ref.setUserSession;var isAuthenticated=useSelector(selectIsAuthenticated);var _useState=useState(true),_useState2=_slicedToArray(_useState,2),isAuthenticating=_useState2[0],setIsAuthenticating=_useState2[1];var cookies=new Cookies();var onLoad=useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var token,currentSession;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:try{token=cookies.get(CONSTANTS.JWT_NAME);currentSession=JSON.parse(atob(token.split('.')[1]));setUserSession(currentSession);userHasAuthenticated(true);}catch(e){userHasAuthenticated(false);}setIsAuthenticating(false);case 2:case\"end\":return _context.stop();}}},_callee);})),[setUserSession,userHasAuthenticated]);useEffect(function(){onLoad();},[onLoad,isAuthenticated]);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Routes,{appProps:{isAuthenticated:isAuthenticated,userHasAuthenticated:userHasAuthenticated}}),/*#__PURE__*/_jsx(Notifier,{})]});}var mapDispatchToProps=function mapDispatchToProps(dispatch){return{userHasAuthenticated:function userHasAuthenticated(values){return dispatch(userHasAuthenticatedAction(values));},setUserSession:function setUserSession(values){return dispatch(userSessionAction(values));}};};var withConnect=connect(null,mapDispatchToProps);export default compose(withRouter,withConnect)(App);","map":{"version":3,"sources":["/Users/lasimonne/Projects/syked.xyz/src/App.js"],"names":["React","useState","useEffect","useCallback","Cookies","compose","connect","useSelector","withRouter","selectIsAuthenticated","userHasAuthenticated","userHasAuthenticatedAction","userSession","userSessionAction","Notifier","CONSTANTS","Routes","App","setUserSession","isAuthenticated","isAuthenticating","setIsAuthenticating","cookies","onLoad","token","get","JWT_NAME","currentSession","JSON","parse","atob","split","e","mapDispatchToProps","dispatch","values","withConnect"],"mappings":"2cAAA,mCACA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,SAA1B,CAAqCC,WAArC,KAAwD,OAAxD,CAEA,OAASC,OAAT,KAAwB,cAAxB,CACA,OAASC,OAAT,KAAwB,OAAxB,CACA,OAASC,OAAT,CAAkBC,WAAlB,KAAqC,aAArC,CACA,OAASC,UAAT,KAA2B,kBAA3B,CAEA,OACEC,qBACA;AAFF,CAGEC,oBAAoB,GAAIC,CAAAA,0BAH1B,CAIEC,WAAW,GAAIC,CAAAA,iBAJjB,KAKO,2BALP,CAMA,MAAOC,CAAAA,QAAP,KAAqB,qBAArB,CACA,MAAO,GAAKC,CAAAA,SAAZ,KAA2B,kBAA3B,CAEA,MAAOC,CAAAA,MAAP,KAAmB,UAAnB,CACA,MAAO,YAAP,C,6IACA,QAASC,CAAAA,GAAT,MAAuD,IAAxCP,CAAAA,oBAAwC,MAAxCA,oBAAwC,CAAlBQ,cAAkB,MAAlBA,cAAkB,CACrD,GAAMC,CAAAA,eAAe,CAAGZ,WAAW,CAACE,qBAAD,CAAnC,CACA,cAAgDR,QAAQ,CAAC,IAAD,CAAxD,wCAAOmB,gBAAP,eAAyBC,mBAAzB,eACA,GAAMC,CAAAA,OAAO,CAAG,GAAIlB,CAAAA,OAAJ,EAAhB,CAEA,GAAMmB,CAAAA,MAAM,CAAGpB,WAAW,sEAAC,4JACzB,GAAI,CACIqB,KADJ,CACYF,OAAO,CAACG,GAAR,CAAYV,SAAS,CAACW,QAAtB,CADZ,CAEIC,cAFJ,CAEqBC,IAAI,CAACC,KAAL,CAAWC,IAAI,CAACN,KAAK,CAACO,KAAN,CAAY,GAAZ,EAAiB,CAAjB,CAAD,CAAf,CAFrB,CAGFb,cAAc,CAACS,cAAD,CAAd,CACAjB,oBAAoB,CAAC,IAAD,CAApB,CACD,CAAC,MAAOsB,CAAP,CAAU,CACVtB,oBAAoB,CAAC,KAAD,CAApB,CACD,CACDW,mBAAmB,CAAC,KAAD,CAAnB,CATyB,sDAAD,GAUvB,CAACH,cAAD,CAAiBR,oBAAjB,CAVuB,CAA1B,CAYAR,SAAS,CAAC,UAAM,CACdqB,MAAM,GACP,CAFQ,CAEN,CAACA,MAAD,CAASJ,eAAT,CAFM,CAAT,CAIA,mBACE,wCACE,KAAC,MAAD,EAAQ,QAAQ,CAAE,CAAEA,eAAe,CAAfA,eAAF,CAAmBT,oBAAoB,CAApBA,oBAAnB,CAAlB,EADF,cAEE,KAAC,QAAD,IAFF,GADF,CAMD,CAOD,GAAMuB,CAAAA,kBAAkB,CAAG,QAArBA,CAAAA,kBAAqB,CAACC,QAAD,QAAe,CACxCxB,oBAAoB,CAAE,8BAACyB,MAAD,QAAYD,CAAAA,QAAQ,CAACvB,0BAA0B,CAACwB,MAAD,CAA3B,CAApB,EADkB,CAExCjB,cAAc,CAAE,wBAACiB,MAAD,QAAYD,CAAAA,QAAQ,CAACrB,iBAAiB,CAACsB,MAAD,CAAlB,CAApB,EAFwB,CAAf,EAA3B,CAKA,GAAMC,CAAAA,WAAW,CAAG9B,OAAO,CAAC,IAAD,CAAO2B,kBAAP,CAA3B,CAEA,cAAe5B,CAAAA,OAAO,CAACG,UAAD,CAAa4B,WAAb,CAAP,CAAiCnB,GAAjC,CAAf","sourcesContent":["/* eslint-disable no-unused-vars */\nimport React, { useState, useEffect, useCallback } from 'react';\nimport PropTypes from 'prop-types';\nimport { Cookies } from 'react-cookie';\nimport { compose } from 'redux';\nimport { connect, useSelector } from 'react-redux';\nimport { withRouter } from 'react-router-dom';\n\nimport {\n  selectIsAuthenticated,\n  // selectUser,\n  userHasAuthenticated as userHasAuthenticatedAction,\n  userSession as userSessionAction,\n} from 'containers/Auth/authSlice';\nimport Notifier from 'components/Notifier';\nimport * as CONSTANTS from 'common/constants';\n\nimport Routes from './Routes';\nimport './App.scss';\nfunction App({ userHasAuthenticated, setUserSession }) {\n  const isAuthenticated = useSelector(selectIsAuthenticated);\n  const [isAuthenticating, setIsAuthenticating] = useState(true);\n  const cookies = new Cookies();\n\n  const onLoad = useCallback(async () => {\n    try {\n      const token = cookies.get(CONSTANTS.JWT_NAME);\n      const currentSession = JSON.parse(atob(token.split('.')[1]));\n      setUserSession(currentSession);\n      userHasAuthenticated(true);\n    } catch (e) {\n      userHasAuthenticated(false);\n    }\n    setIsAuthenticating(false);\n  }, [setUserSession, userHasAuthenticated]);\n\n  useEffect(() => {\n    onLoad();\n  }, [onLoad, isAuthenticated]);\n\n  return (\n    <>\n      <Routes appProps={{ isAuthenticated, userHasAuthenticated }} />\n      <Notifier />\n    </>\n  );\n}\n\nApp.propTypes = {\n  userHasAuthenticated: PropTypes.func,\n  setUserSession: PropTypes.func,\n};\n\nconst mapDispatchToProps = (dispatch) => ({\n  userHasAuthenticated: (values) => dispatch(userHasAuthenticatedAction(values)),\n  setUserSession: (values) => dispatch(userSessionAction(values)),\n});\n\nconst withConnect = connect(null, mapDispatchToProps);\n\nexport default compose(withRouter, withConnect)(App);\n"]},"metadata":{},"sourceType":"module"}